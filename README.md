# MO-AFN: Multi-Omics Attention Fusion Network

## ğŸ§  Precision Psychiatry Treatment Prediction

![Python](https://img.shields.io/badge/Python-3.8%2B-blue)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0%2B-red)
![Status](https://img.shields.io/badge/Status-Research%20Prototype-orange)

**MO-AFN** is a deep learning framework designed to predict antidepressant treatment responses by fusing **Genomics (SNPs)**, **Transcriptomics (Gene Expression)**, and **Clinical Data**. It addresses the challenge of identifying "Treatment Resistant" patients by leveraging a novel **Cross-Modal Attention Mechanism** that learns non-linear interactions between biological and clinical factors.

---

## ğŸš€ Key Features

*   **Multi-Modal Fusion:** Integrates 5000+ Genes/SNPs with clinical history using an adaptive attention layer.
*   **Latent Space Compression:** Uses Parallel Denoising Autoencoders (DAE) to reduce high-dimensional Omics data.
*   **Clinical Trust Measures:**
    *   **Uncertainty Estimation:** Monte Carlo Dropout provides confidence scores (e.g., "82% Â± 4%").
    *   **Explainable AI (XAI):** Includes SHAP beeswarm plots, Attention Heatmaps, and Patient Radar Charts.
*   **Bayesian Optimization:** Automated hyperparameter tuning using **Optuna**.

---

## ğŸ“‚ Project Structure

```plaintext
MO_AFN_Project/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                  # Source files (GEO/PGC downloads)
â”‚   â””â”€â”€ synthetic/            # Generated mock tensors for testing
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data_acquisition/     # Scripts to fetch data from NCBI/Kaggle
â”‚   â”œâ”€â”€ preprocessing/        # Phase 1: Autoencoders & QC logic
â”‚   â”œâ”€â”€ models/               # Phase 2: MO-AFN Network & Optuna Optimization
â”‚   â”œâ”€â”€ training/             # Phase 3: Clinical Trainer (Weighted Loss)
â”‚   â””â”€â”€ evaluation/           # Phase 4: Visualization Suite (EDA, XAI, Metrics)
â”‚
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ figures/              # Generated high-quality plots
â”‚       â”œâ”€â”€ eda/              # Exploratory Data Analysis
â”‚       â”œâ”€â”€ evaluation/       # Benchmarks & UMAP
â”‚       â”œâ”€â”€ performance/      # ROC/PR Curves
â”‚       â””â”€â”€ xai/              # SHAP & Radar Charts
â”‚
â””â”€â”€ docs/                     # Data Access Requests & Documentation
```

---

## ğŸ› ï¸ Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/prabanand-sc/MO-AFN.git
    cd MO-AFN/MO_AFN_Project
    ```

2.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    # Additional libraries for visualization
    pip install optuna shap umap-learn mne-connectivity
    ```

---

## â–¶ï¸ How to Run

### Phase 1: Data Engineering
Generate mock data and train the compression Autoencoders.
```bash
python src/preprocessing/phase1_pipeline.py
```
*Output: Compressed Latent Vectors.*

### Phase 2: Optimization
Tune hyperparameters (Learning Rate, Dropout) using Bayesian Optimization.
```bash
python src/models/optimization/bayesian_opt.py
```
*Output: Best trial parameters.*

### Phase 3 & 4: Model Evaluation & Visualization
Generate the full suite of research figures (Benchmarks, Explainability, etc.).
```bash
python src/evaluation/generate_eda_plots.py
python src/evaluation/generate_performance_metrics.py
python src/evaluation/generate_xai_plots.py
python src/evaluation/generate_fusion_plots.py
```
*Output: Check `notebooks/figures/` for the generated PNG files.*

---

## ğŸ“Š Results & Visualization

The project automatically generates publication-ready figures:

| Category | Description | File Path |
| :--- | :--- | :--- |
| **Performance** | Comparative ROC/PR Curves & Result Tables | `notebooks/figures/performance/` |
| **Explainability** | SHAP Bee-swarm & Attention Heatmaps | `notebooks/figures/xai/` |
| **Personalization** | Patient-Specific Radar Charts | `notebooks/figures/xai/` |
| **Validation** | UMAP Latent Space Clusters | `notebooks/figures/evaluation/` |

---

## ğŸ” Data Privacy

This project currently uses **Synthetic Mock Data** generated by internal scripts to ensure no identifiable patient data is exposed. Real data integration requires access approval from **PGC** and **NCBI GEO**.

---

## ğŸ“ License

This project is intended for **Academic Research Purposes**.
